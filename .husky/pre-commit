#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Äang cháº¡y 8 cÃ´ng cá»¥ kiá»ƒm tra (ESLint, tsc, ggshield, Gitleaks, Talisman, njsscan, Prettier, Husky)..."

# 1. Prettier & ESLint & tsc (thÃ´ng qua lint-staged)
npx lint-staged || exit 1

# 2. njsscan (Security)
echo "ğŸ›¡ï¸ Cháº¡y njsscan..."
njsscan . || exit 1

# 3. Gitleaks (Secrets)
echo "ğŸ”‘ Cháº¡y Gitleaks..."
./scripts/bin/gitleaks detect --source . --staged -v || exit 1

# 4. Talisman (Secrets & sensitive files)
echo "ğŸ’ Cháº¡y Talisman..."
./scripts/bin/talisman --githook pre-commit || exit 1

# 5. ggshield (GitGuardian)
# LÆ°u Ã½: Cháº¿ Ä‘á»™ offline cá»§a ggshield váº«n cáº§n cáº¥u hÃ¬nh ban Ä‘áº§u, 
# nhÆ°ng chÃºng ta Ã©p nÃ³ cháº¡y scan cá»¥c bá»™.
echo "ğŸ›¡ï¸ Cháº¡y ggshield..."
ggshield secret scan pre-commit || exit 1

echo "âœ… ÄÃ£ vÆ°á»£t qua táº¥t cáº£ cÃ¡c bÃ i kiá»ƒm tra. Äang thá»±c hiá»‡n commit..."
